# E2-算法第2次练习赛

# 组合背包

时间限制: 1000 ms 内存限制: 65536 kb

总通过人数: 311 总提交人数: 316

## 题面

组合背包：有的物品只可以取一次（01背包），有的物品可以取无限次（完全背包），有的物品可以取的次数有一个上限（多重背包）。

## 输入

多组输入数据

每组数据第一行两个数n，v，表示物品的数量和背包的容量。(1≤𝑛≤500,1≤𝑣≤300001≤n≤500,1≤v≤30000)

接下来n行，每行三个整数，表示物品的费用,价值,数量(1≤𝑐𝑖,𝑤𝑖≤500,1≤𝑚𝑖≤2001≤ci,wi≤500,1≤mi≤200)，如果m等于233 表示物品可以无限取。

## 输出

每组数据一行一个数

## 输入样例

```
3 10
2 2 233
2 3 1 
3 4 3
```

## 输出样例

```
13
```

## 思路

**模板题，具体参见背包九讲**

**01背包和完全背包的优化很清楚了，核心的关键点在于多重背包的方式，本模板包括以下几种**

- **二进制优化**
- **非stl的单调队列优化**
- **采用deque的单调队列优化**

**虽然在本题的运行时间不一定比最普通的做法更优，但是在极端数据面前会体现其优势。一般来说是中间的这个最优**

# 股票IV

时间限制: 1000 ms 内存限制: 65536 kb

总通过人数: 257 总提交人数: 284

## 题面

假设您有一个数组，第i个元素是第i天给定股票的价格。

设计算法以找到最大的利润。您最多可以完成k次交易。

请注意，无法同时进行多项交易（即必须先出售股票才能再次购买）

## 输入

多组输入数据

每组数据第一行两个数n,k，表示总天数和最多交易次数。(1≤n,k≤10^3)

接下来一行n个数表示股票的价格(1≤ai≤10^9)

## 输出

每组数据一行一个数

## 输入样例

```
5 2
1 2 3 4 5
```

## 输出样例

```
4
```

## 思路

**本题必须当做一个dp来进行**

**最基础的想法，f[i k x]第i天进行到第k次交易，x是0表示这次交易结束，1则是这次交易进行中**

**最一开始是k=0 x=1买入，到最后是k=K x=0的时候全部结束**，过程就是(0,1) (1,0) (1,1),.....

**可以理解为，买入的时刻要减去买入的价格，然后卖出的时候加上卖出的价格即可**

对应的状态转移方程如下

- **dp[i k 0] = max(dp[i-1 k 0], dp[i-1 k-1 1] + a[i])**
- **dp[i k 1] = max(dp[i-1 k 1], dp[i-1 k 0] - a[i])**

起始状态如下

- **dp[1 i 1] = -a[1] (边界:如果做不了k次交易，那么初始都要强制买入a[1]，注意题目是最多k次)**
- **dp[i 0 1] = max(dp[i - 1 0 1], dp[i - 1 0 0] - a[i])   (从哪里开始决定买入)**

本题同样可以通过wqs二分，分析结果曲线的凸性来完成，复杂度为O(nlogn)
