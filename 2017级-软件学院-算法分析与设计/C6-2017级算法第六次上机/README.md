# C6-2017级算法第六次上机

**注:在比赛界面，可以看到本次上机的所有题目，但是除了本项目收录的B题其他题目都不能做**

**其他题目我可以大致说一下算法标签是什么...因为确实都太简单了...**

**A是FFT高精度乘法的模板 C是平键最近点对的分治模板 D是坐标的极角排序模板(求凸包就要用这个) E是通过叉乘判断左转右转 F是线段相交模板(在相交的基础上需要判断出非规范相交) G是叉积和点积的模板**

# 石头剪子布

时间限制: 1000 ms 内存限制: 65536 kb

总通过人数: 117 总提交人数: 150

## 题目描述

石头Rock剪子Scissors布Paper。

想哥和叶姐又开始这个有趣的游戏。众所周知，他们俩的游戏不可能公平。他们分别给出自己出的序列（RSP分别代表石头、剪刀、布）。

想哥给出一个长度为n的序列，而叶姐给出长度为m的序列。1≤𝑚<𝑛≤100,0001≤m<n≤100,000。叶姐显然有特权，她可以选择跳过想哥序列的一段开头，才开始将RSP序列进行匹配，以寻求从这一位置开始最多获胜次数。

请你帮叶姐求出这一次数，这就是想哥请17级吃饭的次数。显然，R胜S，S胜P，P胜R。

## 输入

第一行为n，m，含义如上。

接下来两行分别为想哥和叶姐的RSP序列。

## 输出

输出一行，最大获胜数

## 输入样例1

```
12 4
RSPPSSSRRPPR
RRRR
```

## 输出样例1

```
3
```

## 输入样例2

```
12 4
PPPRRRRRRRRR
RSSS
```

## 输出样例2

```
2
```

## 输入样例3

```
12 4
RRRRRRRRRSSS
RRRS
```

## 输出样例3

```
3
```

## Hint

对于从哪里开始的匹配规则，请多参照样例2、3。

对于50%的数据，𝑛,𝑚≤4000n,m≤4000.（三方的算法就不要交了）

## 思路

**这个题基本可以看出，是FFT在字符串匹配相关的应用，非常有趣的是，生医专业在进行碱基配对的匹配度计算时，同样会用到FFT这个算法。**

**具体来说，本题就是FFT在模式串匹配的入门题目**

因为对称性，我们不妨先考虑叶姐出剪刀，想哥出布的这个情况

**那么只考虑叶姐的剪刀能赢多少次的时候，只需要把剪刀的位置赋值1，想哥出布的位置赋值1，其他全都赋值0，再将叶姐倒置，FFT得出的x^i的系数就是在某一位对齐的时候，出剪刀赢的场次**

**3次FFT系数相加之后取最大值，即为最终所求。**