# E2-21级离散数学2-图论

# `A` 最短通路

时间限制: 2000 ms 内存限制: 65536 kb

总通过人数: 17 总提交人数: 30

## 题目描述

观赛完运动会之后，花叶需要立马去BITTO的钢条厂上班，由于北航到钢条厂的路径有很多条，他希望选择一条最短的！

形式化来说，给一个 $n$ 个点 $m$ 条边的带权无向图，求点 $s$ 到点 $t$ 的最短路路径以及长度。

**只能使用`Python`提交**

## 输入

第一行四个正整数 $n,m,s,t$，其中 $1≤n≤2.5×10^3$，$1≤m≤7×10^3$，$1≤s,t≤n$，含义如题目所示。

第二行一个正整数 $p$，表示是否需要输出具体最短路径，$1$ 表示需要输出最短路径，$0$ 表示不需要。

接下来 $m$ 行，每行三个正整数 $u_i,v_i,w_i$，其中 $1≤u_i,v_i≤n$，$1≤wi≤10^3$，表示第 $i$ 条边 $(u_i,v_i)$ 的权值为 $w_i$。

图中有可能存在重边和自环。

## 输出

- 如果 $p=1$，则输出一共两行

  第一行：路径，从源点到终点依次输出所经过得节点；第二行：一个非负整数，表示点 $s$ 到点 $t$ 的最短路长度。

  数据保证仅一条通路。

- 如果 $p=0$ ，则输出一行一个非负整数，表示点 $s$ 到点 $t$ 的最短路长度。

## 输入样例1

```
8 15 1 8
1
1 2 5
2 5 6
5 8 5
1 3 2
3 6 3
6 8 9
1 4 3
4 7 1
7 8 11
3 2 1
3 5 7
4 3 6
3 7 1
7 6 3
6 5 1
```

## 输出样例1

```
1 3 6 5 8
11
```

## 输入样例2

```
7 11 5 4
0
2 4 2
1 4 3
7 2 2
3 4 3
5 7 5
7 3 3
6 1 1
6 3 4
2 4 3
5 6 3
7 2 1
```

## 输出样例2

```
7
```

## Hint

请注意重边和自环的处理，不需要对最短路算法进行优化就可以通过本题。

经典图论问题，该题所有伪代码可以见算法导论或算法课 PPT。

## 思路

**dijkstra+最短路径树模板**

dijkstra跑最短路的同时需要存储最短路径树的边，并从终点回溯遍历到起点，即为起点到终点的最短路径

虽然本题 $O(n^2)$ 即可通过，但是这里还是给出 $O(n\log n)$ 的堆优化做法吧（毕竟这个也更常用一些）。

另外需要注意的是，这题要求和19级的对应题目不同，本题是无向图，那题是有向图。得30分的都是直接按照有向图做了。

# `B` 关键通路

时间限制: 1000 ms 内存限制: 65536 kb

总通过人数: 19 总提交人数: 19

## 题目描述

观赛完运动会之后，花叶现在已经在钢条厂上班，但是钢条厂繁杂的流水线让花叶很是苦恼，他希望你来帮他求一下关键通路！

花叶其实在瞬间就计算完毕了，但是他不确定是不是正确的，于是他希望你也帮忙计算一下关键通路是什么。

形式化来说，给一个 $n$ 个点 $m$ 条边的带权有向图，求点 $s$ 到点 $t$ 的关键通路。

## 输入

第一行四个正整数 $n,m,s,t$，其中 $1≤n≤15$ ，$1≤s,t≤n$，含义如题目所示。

接下来 $m$ 行，每行三个正整数 $u_i,v_i,w_i$ ，其中 $1≤u_i,v_i≤n$，$1≤w_i≤10^3$，表示第 $i$ 条边 $(u_i,v_i)$ 的权值为 $w_i$。

## 输出

第一行输出关键通路的长度；

第二行到第 $n+1$ 行输出每一个顶点的 TE, TL 和缓冲时间；

最后一行按Hint中所给格式，输出**所有**的关键通路。（若有多条，则根据关键通路中节点的个数排序进行输出，长度相同则按字典序排）

## 输入样例

```
9 15 1 9
1 2 3
1 3 2
1 4 4
2 5 4
2 3 0
3 5 4
3 6 4
3 4 2
4 7 5
5 9 6
5 7 3
5 6 0
6 8 3
8 9 1
7 8 1
```

## 输出样例

```
Dis=13
Node 1: TE=   0  TL=   0  TL-TE= 0
Node 2: TE=   3  TL=   3  TL-TE= 0
Node 3: TE=   3  TL=   3  TL-TE= 0
Node 4: TE=   5  TL=   6  TL-TE= 1
Node 5: TE=   7  TL=   7  TL-TE= 0
Node 6: TE=   7  TL=   9  TL-TE= 2
Node 7: TE=  10  TL=  11  TL-TE= 1
Node 8: TE=  11  TL=  12  TL-TE= 1
Node 9: TE=  13  TL=  13  TL-TE= 0
[[1, 2, 5, 9], [1, 2, 3, 5, 9]]
```

## Hint

本题目仅支持Python，想通过默认c语言提交的同学注意了哦。

得0.66的同学注意当长度相等时的排序问题

建立"数组"(其实这里是List列表数据类型)：

```
array = [value]*n
array = [[value for i in range(n)] for j in range(m)] # 二维
```

格式化输出：

```
print("Dis=", distance[end], sep="")
print("Node",i, end="")
print(": TE= %3d" % (te[i]), sep="", end=" ")
print(" TL= %3d" % (tl[i]), sep="", end=" ")
print(" TL-TE= ", tl[i] - te[i], sep="")
```

关键通路输出：

```
print(array)
# 如果你把所有的路径都存在一个List里，可以直接这样print，这里的array为二维的
```

对多条通路进行排序：

```
sorted(all_paths, key = len)
```

## 思路

**关键通路问题，求最长通路**

**具体的TL和TE的计算参考书籍即可，根据正向图与反向图分别进行BFS拓扑排序即可获得**

**具体求关键通路，则直接用dfs（类似于全排列）即可，结合TE和TL可以判断其是否是关键路径的节点**

**最后注意格式化输出**，保证和hint一致即可。然后就是对 `vector` 不要使用默认的排序，要按照题目中的排序关系来排

